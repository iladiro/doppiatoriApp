<div class="container" *ngIf="dubberService.dubber">
  <div *ngIf="status == true" class="alert alert-success">
    Dubber updated with success!
  </div>
  <div class="row">
    <div class="col-sm-2">
      <figure>
        <img src="/assets/images/default-user-image.png" alt="The Pulpit Rock" class="img-fluid img-thumbnail">
        <h5 class="mt-10 text-capitalize">{{dubberService.dubber.name}} {{dubberService.dubber.surname}}</h5>
      </figure>
    </div>
    <div class="col-sm-10">
      <!-- Nav tabs -->
      <ul class="nav nav-tabs" role="tablist">
        <li class="nav-item">
          <a class="nav-link active" data-toggle="tab" href="#personal-data" role="tab">Personal data</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#collaborations" role="tab">Collaborations</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" data-toggle="tab" href="#invoices" role="tab">Invoices</a>
        </li>
      </ul>

      <!-- Tab panes -->
      <div class="tab-content pboth-15">
        <div class="tab-pane active" id="personal-data" role="tabpanel">
          <form #UpdateDubberForm="ngForm" (ngSubmit)="upDateParsonalDate(UpdateDubberForm)">
            <fieldset class="pl-0 pr-0">
              <legend>Personal information:</legend>
              <div class="form-row">
                <div class="col-sm-6 mb-3">
                  <label for="name">Name</label>
                  <input type="text" id="name" class="form-control text-capitalize" placeholder="First name" [(ngModel)]="dubberService.dubber.name" name="name" required>
                </div>
                <div class="col-sm-6 mb-3">
                  <label for="surname">Surname</label>
                  <input type="text" id="surname" class="form-control text-capitalize" placeholder="Last name" [(ngModel)]="dubberService.dubber.surname" name="surname" required>
                </div>
                <div class="col-sm-6 mb-3">
                  <label for="name">Fiscal Code</label>
                  <input type="text" id="fiscalCode" class="form-control text-uppercase" placeholder="Fiscal Code" [(ngModel)]="dubberService.dubber.fiscalCode" name="fiscalCode" pattern="^[a-zA-Z]{6}[0-9]{2}[a-zA-Z][0-9]{2}[a-zA-Z][0-9]{3}[a-zA-Z]$" required>
                </div>
                <div class="col-sm-6 mb-3">
                  <label for="name">Date of birth</label>
                  <input type="text" id="birthdate" class="form-control" placeholder="DD/MM/YYYY" [(ngModel)]="dubberService.dubber.birthdate" name="birthdate" required>
                </div>
                <div class="col-sm-6 mb-3">
                  <label for="name">Place of birth</label>
                  <input type="text" id="birthplace" class="form-control text-capitalize" placeholder="Place of birth" [(ngModel)]="dubberService.dubber.birthplace" name="birthplace" required>
                </div>
                <div class="col-sm-6 mb-3">
                  <label for="name">County of birth</label>
                  <input type="text" id="birthcounty" class="form-control text-capitalize" placeholder="County of birth" [(ngModel)]="dubberService.dubber.birthcounty" name="birthcounty" required>
                </div>
              </div>
            </fieldset>
            <fieldset class="pl-0 pr-0">
              <legend>Tax information:</legend>
              <div class="form-row">
                <div class="col-sm-12 col-md-4 mb-3">
                  <label for="residenceplace">Place of residence</label>
                  <input id="residenceplace" type="text" class="form-control text-capitalize" placeholder="Place of residence" [(ngModel)]="dubberService.dubber.residenceplace" name="residenceplace" #residenceplace="ngModel" required>
                  <div class="alert alert-danger" *ngIf="residenceplace.touched && !residenceplace.valid">Field is not valid</div>
                </div>
                <div class="col-sm-12 col-md-4 mb-3">
                  <label for="residenceaddress">Address</label>
                  <input id="residenceaddress" type="text" class="form-control text-capitalize" placeholder="Address" [(ngModel)]="dubberService.dubber.residenceaddress" name="residenceaddress" #residenceaddress="ngModel" required>
                  <div class="alert alert-danger" *ngIf="residenceaddress.touched && !residenceaddress.valid">Field is not valid</div>
                </div>
                <div class="col-sm-12 col-md-4 mb-3">
                  <label for="residencecountry">Country of residence</label>
                  <input id="residencecountry" type="text" class="form-control text-capitalize" placeholder="Country of residence" [(ngModel)]="dubberService.dubber.residencecountry" name="residencecountry" #residencecountry="ngModel" required>
                  <div class="alert alert-danger" *ngIf="residencecountry.touched && !residencecountry.valid">Field is not valid</div>
                </div>
              </div>
            </fieldset>
            <fieldset class="pl-0 pr-0">
              <legend>Contacts information:</legend>
              <div class="form-row">
                <div class="col-sm-6 mb-3">
                  <label for="email">Email</label>
                  <input type="email" id="email" class="form-control" placeholder="Email" [(ngModel)]="dubberService.dubber.email" name="email" required #email="ngModel" pattern="^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$">
                  <div class="alert alert-danger" *ngIf="email.touched && !email.valid">Field is not valid</div>
                </div>
                <div class="col-sm-6 mb-3">
                  <label for="phone">Phone</label>
                  <input type="phone" id="phone" class="form-control" placeholder="Phone" [(ngModel)]="dubberService.dubber.phone" name="phone" required #phone="ngModel" pattern="[0-9]+">
                  <div class="alert alert-danger" *ngIf="phone.touched && !phone.valid">Field is not valid</div>
                </div>
              </div>
            </fieldset>
            <button type="submit" class="btn btn-success">Update dubber</button>
          </form>
        </div>
        <div class="tab-pane" id="collaborations" role="tabpanel">
          <section class="itemsList" *ngIf="dubberService.dubber.film.length; else noFilm">
            <div class="itemsList__body">
              <div class="itemsList__body-row row"  *ngFor="let dubberFilm of dubberService.dubber.film">
                <div class="col pt-20">
                  {{dubberFilm.title}}
                </div>
                <div class="col text-right">
                  <a [routerLink]="['/film', dubberFilm.id]" class="btn btn-outline-primary">
                    <i class="fa fa-info" aria-hidden="true"></i>
                  </a>
                  <button (click)="deleteFilm(dubberFilm.id)" class="btn btn-outline-danger">
                    <i class="fa fa-trash" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
            </div>
          </section>
          <ng-template #noFilm>
            <p class="alert alert-warning">There aren't associated films</p>
          </ng-template>
        </div>
        <div class="tab-pane" id="invoices" role="tabpanel">
          <section class="itemsList" *ngIf="dubberService.dubber.invoices.length; else noInvoices">
            <div class="itemsList__body">
              <div class="itemsList__body-row row" *ngFor="let invoice of dubberService.dubber.invoices">
                <div class="col pt-20">
                  Compenso per prestazione d'opera relativa al film <strong>{{invoice.movie}}</strong>
                </div>
                <div class="col text-right">
                  <a [routerLink]="['/invoice', invoice.id]" class="btn btn-outline-primary">
                    <i class="fa fa-info" aria-hidden="true"></i>
                  </a>
                  <a href="" class="btn btn-outline-success">
                    <i class="fa fa-download"></i>
                  </a>
                  <button (click)="deleteInvoice(invoice)" class="btn btn-outline-danger">
                    <i class="fa fa-trash" aria-hidden="true"></i>
                  </button>
                </div>
              </div>
            </div>
          </section>
          <ng-template #noInvoices>
            <p class="alert alert-warning">There aren't associated invoices</p>
          </ng-template>
          <form #InvoiceForm="ngForm" (ngSubmit)="generateInvoice(InvoiceForm)">
            <div class="form-group">
              <label for="movie">Select movie</label>
              <select name="movie" class="form-control" ngModel>
                <option *ngFor="let movie of dubberService.dubber.film" value="{{movie.title}}">
                  {{movie.title}}
                </option>
                <option disabled *ngIf="!dubberService.dubber.film.length">
                  There aren't associated movies
                </option>
              </select>
            </div>
            <div class="form-group">
              <label for="grossCompensation">Gross compensation</label>
              <input id="grossCompensation" type="text" class="form-control" placeholder="Gross compensation" ngModel name="grossCompensation" #grossCompensation="ngModel" required>
            </div>
            <div class="form-group">
              <label for="taxPercetual">Ritenuta d'acconto del</label>
              <select name="taxPercetual" class="form-control" ngModel>
                <option value="20">20%</option>
                <option value="40">40%</option>
                <option value="50">50%</option>
              </select>
            </div>
            <!-- <div class="form-group">
              <label for="netCompensation">Net compensation</label>
              <input class="form-control" value="{{netCompensation}}" disabled>
            </div> -->
            <button type="submit" class="btn btn-success" [disabled]="!InvoiceForm.valid">Generate invoice</button>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
